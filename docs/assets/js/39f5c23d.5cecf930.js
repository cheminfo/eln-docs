(self.webpackChunkcheminfo_eln=self.webpackChunkcheminfo_eln||[]).push([[2323],{3905:function(e,t,a){"use strict";a.d(t,{Zo:function(){return p},kt:function(){return h}});var n=a(67294);function i(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e}function r(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function o(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?r(Object(a),!0).forEach((function(t){i(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):r(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function s(e,t){if(null==e)return{};var a,n,i=function(e,t){if(null==e)return{};var a,n,i={},r=Object.keys(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||(i[a]=e[a]);return i}(e,t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);for(n=0;n<r.length;n++)a=r[n],t.indexOf(a)>=0||Object.prototype.propertyIsEnumerable.call(e,a)&&(i[a]=e[a])}return i}var l=n.createContext({}),m=function(e){var t=n.useContext(l),a=t;return e&&(a="function"==typeof e?e(t):o(o({},t),e)),a},p=function(e){var t=m(e.components);return n.createElement(l.Provider,{value:t},e.children)},c={inlineCode:"code",wrapper:function(e){var t=e.children;return n.createElement(n.Fragment,{},t)}},d=n.forwardRef((function(e,t){var a=e.components,i=e.mdxType,r=e.originalType,l=e.parentName,p=s(e,["components","mdxType","originalType","parentName"]),d=m(a),h=i,f=d["".concat(l,".").concat(h)]||d[h]||c[h]||r;return a?n.createElement(f,o(o({ref:t},p),{},{components:a})):n.createElement(f,o({ref:t},p))}));function h(e,t){var a=arguments,i=t&&t.mdxType;if("string"==typeof e||i){var r=a.length,o=new Array(r);o[0]=d;var s={};for(var l in t)hasOwnProperty.call(t,l)&&(s[l]=t[l]);s.originalType=e,s.mdxType="string"==typeof e?e:i,o[1]=s;for(var m=2;m<r;m++)o[m]=a[m];return n.createElement.apply(null,o)}return n.createElement.apply(null,a)}d.displayName="MDXCreateElement"},18704:function(e,t,a){"use strict";a.r(t),a.d(t,{frontMatter:function(){return o},contentTitle:function(){return s},metadata:function(){return l},toc:function(){return m},default:function(){return c}});var n=a(22122),i=a(19756),r=(a(67294),a(3905)),o={slug:"/uuid/10b6a7229db7dd815afcc75e77c2d6cd"},s=void 0,l={unversionedId:"structural_analysis/ir-prediction/README",id:"structural_analysis/ir-prediction/README",isDocsHomePage:!1,title:"README",description:"In infrared spectroscopy, broadband infrared light is typically passed through a sample and the transmitted light is dispersed and its spectral intensity recorded.The absorption lines reveal the excited vibrational transitions.",source:"@site/docs/30_structural_analysis/ir-prediction/README.md",sourceDirName:"30_structural_analysis/ir-prediction",slug:"/uuid/10b6a7229db7dd815afcc75e77c2d6cd",permalink:"/docs/eln/uuid/10b6a7229db7dd815afcc75e77c2d6cd",editUrl:"https://github.com/cheminfo/eln-docs/edit/main/docs/30_structural_analysis/ir-prediction/README.md",version:"current",frontMatter:{slug:"/uuid/10b6a7229db7dd815afcc75e77c2d6cd"},sidebar:"tutorialSidebar",previous:{title:"Elemental analysis",permalink:"/docs/eln/uuid/bf1f6acc30fc6c92c730ea434234530c"},next:{title:"Infrared spectra",permalink:"/docs/eln/uuid/3fc7caa33b9b3eb50bb48920f4788725"}},m=[{value:"Theoretical background",id:"theoretical-background",children:[{value:"Selection rules",id:"selection-rules",children:[]},{value:"IR spectra",id:"ir-spectra",children:[]},{value:"Finite differences",id:"finite-differences",children:[]},{value:"Degrees of freedoms and imaginary frequencies",id:"degrees-of-freedoms-and-imaginary-frequencies",children:[]}]},{value:"Using the view",id:"using-the-view",children:[]},{value:"References",id:"references",children:[]}],p={toc:m};function c(e){var t=e.components,a=(0,i.Z)(e,["components"]);return(0,r.kt)("wrapper",(0,n.Z)({},p,a,{components:t,mdxType:"MDXLayout"}),(0,r.kt)("p",null,"In infrared spectroscopy, broadband infrared light is typically passed through a sample and the transmitted light is dispersed and its spectral intensity recorded.The absorption lines reveal the excited vibrational transitions."),(0,r.kt)("h1",{id:"ir-spectra-prediction"},"IR spectra prediction"),(0,r.kt)("h2",{id:"theoretical-background"},"Theoretical background"),(0,r.kt)("h3",{id:"selection-rules"},"Selection rules"),(0,r.kt)("p",null,"From theoretical spectroscopy one can derive that an electronic transition between some initial state $i$ and final state $f$ is allowed if the transition moment is not zero:"),(0,r.kt)("p",null,"$$\n|\\mathbf{\\mu}",(0,r.kt)("em",{parentName:"p"},"{if}| = \\left| \\int \\psi"),"{\\mu",(0,r.kt)("em",{parentName:"p"},"f}^* \\mathbf{\\mu} \\psi"),"{\\mu_i} \\mathrm{d}V \\right|\n$$"),(0,r.kt)("p",null,"If we assume that the Born-Oppenheimer approximation holds, we can separate the wave functions $\\psi$ into an electronic and nuclear part and analyze them separately:"),(0,r.kt)("p",null,"$$\n\\psi_\\mu(\\mathbf{r}) = \\psi_e (\\mathbf{r}_e, \\mathbf{r}_N) \\cdot \\psi_N (\\mathbf{r}_N)\n$$"),(0,r.kt)("p",null,"If we focus, for simplicity, on diatomic molecules we can decompose the nuclear motion into an oscillation (harmonic oscillator) and rotation (rigid rotator) part:"),(0,r.kt)("p",null,"$$\n\\psi",(0,r.kt)("em",{parentName:"p"},"N(\\mathbf{r}_N) = \\psi_v(q) \\cdot \\psi"),"{J, m_J} (\\theta, \\phi)\n$$"),(0,r.kt)("p",null,"with $q$ being the internuclear distance."),(0,r.kt)("p",null,"For vibrational transitions we can analyze only the contributions from the oscillation part, for which the wave function can be written as"),(0,r.kt)("p",null,"$$\n\\psi_v(q) = A_v \\cdot H_v(\\alpha q) \\exp\\left(-\\frac{-(\\alpha q)^2}{2}\\right)\n$$"),(0,r.kt)("p",null,"where the $H_v$ are Hermite polynomials."),(0,r.kt)("p",null,"For the vibrational transition, we can now evaluate"),(0,r.kt)("p",null,"$$\n\\mathbf{\\mu}",(0,r.kt)("em",{parentName:"p"},"{if} = \\int \\psi^*"),"{V",(0,r.kt)("em",{parentName:"p"},"f} (q) \\mathbf{\\mu} \\psi"),"{V_i}(q) \\, \\mathrm{d}V\n$$"),(0,r.kt)("p",null,"For the diatomic case, we can simplify to one dimension by setting $q$ to $x$ and $\\mathrm{d}V$ to $\\mathrm{d}x$."),(0,r.kt)("p",null,'The first way this integral can vanish is if $\\mathbf{\\mu}$ is zero. This would mean we do not "see" this transition --- it is forbidden.'),(0,r.kt)("p",null,"For small changes, we can approximate $\\mathbf{\\mu}(x)$ using a Taylor expansion"),(0,r.kt)("p",null,"$$\n\\mu(x) = \\mu",(0,r.kt)("em",{parentName:"p"},"0 + \\left(\\frac{\\mathrm{d}\\mu}{\\mathrm{d}x} \\right)"),"{x=x_0}x + \\dots\n$$"),(0,r.kt)("p",null,"If we plug in the first term, we find that the transition dipole moment is zero because the Hermite polynomials $H_v$ are orthogonal (for $v_i \\neq v_f$):"),(0,r.kt)("p",null,"$$\n\\mathbf{\\mu}",(0,r.kt)("em",{parentName:"p"},"{if} = \\mu_0 \\int"),"{-\\infty}^{\\infty} \\psi^*",(0,r.kt)("em",{parentName:"p"},"{V_f} (x)  \\psi"),"{V_i}(x) \\, \\mathrm{d}x = 0\n$$"),(0,r.kt)("p",null,"For the remaining terms we can write in general"),(0,r.kt)("p",null,"$$\n\\mathbf{\\mu}",(0,r.kt)("em",{parentName:"p"},"{if} = \\frac{1}{n!} \\left(\\frac{\\mathrm{d}^n\\mu}{\\mathrm{d}x} \\right)"),"{x=x",(0,r.kt)("em",{parentName:"p"},"0}\\int"),"{-\\infty}^{\\infty} x^n \\psi^*",(0,r.kt)("em",{parentName:"p"},"{V_f} (x)  \\psi"),"{V_i}(x) \\, \\mathrm{d}x = 0\n$$"),(0,r.kt)("p",null,"which will be zero if"),(0,r.kt)("p",null,"$$\n\\left(\\frac{\\mathrm{d}^n\\mu}{\\mathrm{d}x} \\right)_{x=x_0} = 0\n$$"),(0,r.kt)("p",null,"That is, a molecule must have ",(0,r.kt)("em",{parentName:"p"},"a dipole moment that changes with displacement to show an IR transition"),"."),(0,r.kt)("h4",{id:"specific-selection-rule"},"Specific selection rule"),(0,r.kt)("p",null,"If one analyzes"),(0,r.kt)("p",null,"$$\n\\mathbf{\\mu}",(0,r.kt)("em",{parentName:"p"},"{if} = \\frac{1}{n!} \\left(\\frac{\\mathrm{d}^n\\mu}{\\mathrm{d}x} \\right)"),"{x=x",(0,r.kt)("em",{parentName:"p"},"0}\\int"),"{-\\infty}^{\\infty} x^n \\psi^*",(0,r.kt)("em",{parentName:"p"},"{V_f} (x)  \\psi"),"{V_i}(x) \\, \\mathrm{d}x = 0\n$$"),(0,r.kt)("p",null,"in the harmonic approximation one finds that only transitions between neighboring levels are allowed $\\Delta \\nu = \\pm 1$.\nReal bonds, however, are not perfectly harmonic. For this reason, also higher order transitions might be allowed -- those are called overtones and are of lower intensity."),(0,r.kt)("h3",{id:"ir-spectra"},"IR spectra"),(0,r.kt)("h3",{id:"finite-differences"},"Finite differences"),(0,r.kt)("p",null,"If we assume our vibrations are harmonic, we can do a good job by approximating the potential around some (local) minimum using a Taylor approximation"),(0,r.kt)("p",null,"$$\nV=V",(0,r.kt)("em",{parentName:"p"},"{0}+\\sum"),"{i=1}^{3 N}\\left(\\frac{\\partial V}{\\partial q",(0,r.kt)("em",{parentName:"p"},"{i}}\\right)"),"{0} q",(0,r.kt)("em",{parentName:"p"},"{i}+\\frac{1}{2} \\sum"),"{i=1}^{3 N}\\left(\\frac{\\partial^{2} V}{\\partial q",(0,r.kt)("em",{parentName:"p"},"{i} \\partial q"),"{j}}\\right)",(0,r.kt)("em",{parentName:"p"},"{0} q"),"{i} q_{j}+\\cdots\n$$"),(0,r.kt)("p",null,"From Newton's equations of motion we know"),(0,r.kt)("p",null,"$$\n\\ddot{q}",(0,r.kt)("em",{parentName:"p"},"{j}+\\sum"),"{i=1}^{3 N} f",(0,r.kt)("em",{parentName:"p"},"{i j} q"),"{i} = 0\n$$"),(0,r.kt)("p",null,"This is a differential equation (of the harmonic oscillator), which is solved, for example, by"),(0,r.kt)("p",null,"$$\nq",(0,r.kt)("em",{parentName:"p"},"{i}=a"),"{i} \\cos (\\sqrt{\\lambda} t+\\phi)\n$$"),(0,r.kt)("p",null,"If we substitute this potential solution back in our differential equation we find an eigenvalue problem"),(0,r.kt)("p",null,"$$\n\\sum",(0,r.kt)("em",{parentName:"p"},"{i=1}^{3 N}\\left(f"),"{i j}-\\delta",(0,r.kt)("em",{parentName:"p"},"{i j} \\lambda\\right) a"),"{i}=0 \\quad j=1,2, \\cdots, 3 N\n$$"),(0,r.kt)("p",null,"What does this mean? The eigenvectors $\\mathbf{a}",(0,r.kt)("em",{parentName:"p"},"k$ are the normal modes that describe the motion of the atoms for the mode with eigenvalue $\\lambda_k$. It is important to realize that according to $a"),"{i} \\cos (\\sqrt{\\lambda} t+\\phi)$ all atoms move with the same phase and frequency -- but different amplitudes. It is important to realize that $\\lambda$ is proportional to the force constant. Stiffer bonds hence mean a higher frequency. This is the connection between electronic effects of the substituents and changes in vibrational frequencies. "),(0,r.kt)("p",null,"What do we now need to do in practice to get to these eigenvalues and eigenvectors?"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},"We need to find an equilibrium geometry. For this, we perform a conformer search and then perform a geometry optimization."),(0,r.kt)("li",{parentName:"ol"},"We need to construct the matrix $\\mathbf{F}$ of second derivatives. For this, we use finite differences of the form")),(0,r.kt)("p",null,"$$\n\\frac{\\partial^{2} E",(0,r.kt)("em",{parentName:"p"},"{e}}{\\partial x"),"{\\alpha} \\partial y",(0,r.kt)("em",{parentName:"p"},"{\\beta}} \\approx\\left[\\left.\\left(\\frac{\\partial E"),"{e}}{\\partial y",(0,r.kt)("em",{parentName:"p"},"{\\beta}}\\right)\\right|"),"{x",(0,r.kt)("em",{parentName:"p"},"{\\alpha}=x"),"{\\alpha 0}+\\Delta x",(0,r.kt)("em",{parentName:"p"},"{\\alpha}}-\\left.\\left(\\frac{\\partial E"),"{e}}{\\partial y",(0,r.kt)("em",{parentName:"p"},"{\\beta}}\\right)\\right|"),"{x",(0,r.kt)("em",{parentName:"p"},"{\\alpha}=x"),"{\\alpha 0}-\\Delta x",(0,r.kt)("em",{parentName:"p"},"{\\alpha}}\\right] / 2 \\Delta x"),"{\\alpha}\n$$"),(0,r.kt)("p",null,"that is, we displace the atoms and then calculate the difference in forces/energies to numerically estimate the second derivative."),(0,r.kt)("p",null,"If we have this matrix, we can solve the eigenvalue problem and get the normal modes with their frequencies."),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Conformer search")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"In our case, conformer generation is based on a ",(0,r.kt)("a",{parentName:"p",href:"https://github.com/rdkit/UGM_2015/blob/master/Presentations/ETKDG.SereinaRiniker.pdf"},"stochastic algorithm that generates random distances within bounds of minimum and maximum distances of pairs of elements"),". It turns out that these distance matrices can be projected into three dimensions, i.e., coordinates for every atom.\nTo improve the performance of these distance geometry algorithms they are often ",(0,r.kt)("a",{parentName:"p",href:"https://pubs.acs.org/doi/abs/10.1021/acs.jcim.5b00654"},"refined using information, such as preferred torsional angles, extracted from the Cambridge Crystallographic database"),"."))),(0,r.kt)("div",{className:"admonition admonition-info alert alert--info"},(0,r.kt)("div",{parentName:"div",className:"admonition-heading"},(0,r.kt)("h5",{parentName:"div"},(0,r.kt)("span",{parentName:"h5",className:"admonition-icon"},(0,r.kt)("svg",{parentName:"span",xmlns:"http://www.w3.org/2000/svg",width:"14",height:"16",viewBox:"0 0 14 16"},(0,r.kt)("path",{parentName:"svg",fillRule:"evenodd",d:"M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"}))),"Semi-empiricial quantum chemistry vs. forcefields")),(0,r.kt)("div",{parentName:"div",className:"admonition-content"},(0,r.kt)("p",{parentName:"div"},"In the view, we give the option to select different methods for geometry optimization and calculation of the vibrational spectrum."),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("em",{parentName:"p"},"Force-fields")," approximate the potential energy surface $U(q)$ in some simple parametrization based on interaction terms between different atom pairs --- often for bonds, bends (angles), and torsions (dihedral angles) between different atom types. The force-field we use in the service is called ",(0,r.kt)("a",{parentName:"p",href:"https://onlinelibrary.wiley.com/doi/full/10.1002/anie.202004239"},"GFN-NN"),". Its parameters were derived from fitting to DFT derived geometries, vibrational frequencies, and non-covalent interactions of about 8000 structures covering a wide range of chemistry. In contrast to other force field parametrizations it uses an electronegativity-equilibrium (EEQ) atomic-charge model to describe the electrostatic interactions and it avoids element ",(0,r.kt)("em",{parentName:"p"},"pair")," specific parametrization ."),(0,r.kt)("p",{parentName:"div"},"From a computational point of view, GFN-FF's computational cost scales quadratically with system size."),(0,r.kt)("p",{parentName:"div"},"The other methods we offer are ",(0,r.kt)("em",{parentName:"p"},"semi-empirical quantum-mechanical")," methods. The key idea behind semi-empirical methods such as the ",(0,r.kt)("a",{parentName:"p",href:"https://en.wikipedia.org/wiki/H%C3%BCckel_method"},"Hueckel method")," is that they approximate difficult integrals. An important flavor of semiempirical methods are ",(0,r.kt)("a",{parentName:"p",href:"https://www.tandfonline.com/doi/full/10.1080/23746149.2019.1710252"},"density-functional tight-binding methods where the energy is expanded in term of density fluctuations relative to a superposition of atomic reference densities"),":"),(0,r.kt)("p",{parentName:"div"},"$$\n\\begin{aligned}\n&E","[\\rho(r)]","=E\\left","[\\rho_{0}(\\mathbf{r})\\right]","+\\left.\\int \\frac{\\delta E","[\\rho(\\mathbf{r})]","}{\\delta \\rho(\\mathbf{r})}\\right|",(0,r.kt)("em",{parentName:"p"},"{\\rho"),"{0}} \\delta \\rho(\\mathbf{r}) ","\\","\n&+\\left.\\frac{1}{2} \\iint \\frac{\\delta^{2} E","[\\rho(\\mathbf{r})]","}{\\delta \\rho(\\mathbf{r}) \\delta \\rho\\left(\\mathbf{r}^{\\prime}\\right)}\\right|",(0,r.kt)("em",{parentName:"p"},"{\\rho"),"{0}} \\delta \\rho(\\mathbf{r}) \\delta \\rho\\left(\\mathbf{r}^{\\prime}\\right) \\ldots ","\\","\n&+\\left.\\frac{1}{p !} \\iint \\ldots \\int \\frac{\\delta E\\left","[\\rho\\left(\\mathbf{r}^{\\prime}\\right)\\right]","}{\\delta \\rho(\\mathbf{r}) \\delta \\rho\\left(\\mathbf{r}^{\\prime}\\right) \\ldots \\delta \\rho\\left(\\mathbf{r}^{(p)}\\right)}\\right|",(0,r.kt)("em",{parentName:"p"},"{\\rho"),"{0}} \\delta \\rho(\\mathbf{r}) \\delta \\rho\\left(\\mathbf{r}^{\\prime \\prime}\\right) \\ldots \\delta \\rho\\left(\\mathbf{r}^{(\\mathbf{p})}\\right)+\\ldots\n\\end{aligned}\n$$"),(0,r.kt)("p",{parentName:"div"},(0,r.kt)("a",{parentName:"p",href:"https://pubs.acs.org/doi/10.1021/acs.jctc.8b01176"},"The GFN-xTB techniques build on top of this idea.")," In approximating the integrals, one introduces empirical parameters which in the GFN-xTB scheme are again fitted for atoms -- but not for the pairs (in contrast to conventional DFTB methods)."))),(0,r.kt)("h3",{id:"degrees-of-freedoms-and-imaginary-frequencies"},"Degrees of freedoms and imaginary frequencies"),(0,r.kt)("p",null,"Key for the interpretation of the spectra is to realize that a system with $N$ particles, has $3N$ degrees of freedom. These degrees of freedom can be aggregated into different collective motions of the atoms: "),(0,r.kt)("ul",null,(0,r.kt)("li",{parentName:"ul"},'3 degrees of freedom describe the movement of the center of mass in the three spatial directions. To say in other words, the "first" three degrees of freedom describe translations.'),(0,r.kt)("li",{parentName:"ul"},"In addition to changing the center of mass, the molecule can also rotate in different ways, which leaves the center of mass fixed. However, we have to make a distinction between linear and non-linear molecules. For linear molecules there is no rotation around the molecular axis -- you can explore this in the view if you compare carbon dioxide and water. For non-linear molecules, however, there are rotations around three distinct axes"),(0,r.kt)("li",{parentName:"ul"},"If we now subtract the translational and rotational modes we have $3N-5$ vibrational degrees of freedom for linear molecules and $3N-6$ vibrational degrees of freedom for non-linear molecules. You can confirm this using the animations in the view. ")),(0,r.kt)("h2",{id:"using-the-view"},"Using the view"),(0,r.kt)("h2",{id:"references"},"References"),(0,r.kt)("ol",null,(0,r.kt)("li",{parentName:"ol"},'Malte Oppermann: Lecture notes for "Electronic spectroscopy", 2015.'),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"https://journals.aps.org/prb/abstract/10.1103/PhysRevB.54.7830"},"Porezag, D. & Pederson, M. R. Infrared intensities and Raman-scattering activities within density-functional theory. Phys. Rev. B 54, 7830\u20137836 (1996).")),(0,r.kt)("li",{parentName:"ol"},(0,r.kt)("a",{parentName:"li",href:"http://vergil.chemistry.gatech.edu/courses/chem6485/pdf/vibrations.pdf"},'C. David Sherrill: Lecture notes "Molecular Vibrations"'))))}c.isMDXComponent=!0}}]);
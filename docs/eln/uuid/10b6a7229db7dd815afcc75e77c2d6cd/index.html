<!doctype html>
<html class="docs-version-current" lang="en" dir="ltr">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<meta name="generator" content="Docusaurus v2.0.0-beta.8">
<link rel="alternate" type="application/rss+xml" href="/docs/blog/rss.xml" title="cheminfo ELN documentation RSS Feed">
<link rel="alternate" type="application/atom+xml" href="/docs/blog/atom.xml" title="cheminfo ELN documentation Atom Feed">
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.13.11/dist/katex.min.css" integrity="sha384-Um5gpz1odJg5Z4HAmzPtgZKdTBHZdw8S29IecapCSB31ligYPhHQZMIlWLYQGVoc" crossorigin="anonymous"><title data-react-helmet="true">IR spectra prediction | cheminfo ELN documentation</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:url" content="https://docs.c6h6.org/docs/eln/uuid/10b6a7229db7dd815afcc75e77c2d6cd"><meta data-react-helmet="true" name="docusaurus_locale" content="en"><meta data-react-helmet="true" name="docusaurus_version" content="current"><meta data-react-helmet="true" name="docusaurus_tag" content="docs-default-current"><meta data-react-helmet="true" property="og:title" content="IR spectra prediction | cheminfo ELN documentation"><meta data-react-helmet="true" name="description" content="In infrared spectroscopy, broadband infrared light is typically passed through a sample and the transmitted light is dispersed and its spectral intensity recorded. The absorption lines reveal the excited vibrational transitions. In the following, we will discuss the theoretical background of these spectra and then show how they can be simulated."><meta data-react-helmet="true" property="og:description" content="In infrared spectroscopy, broadband infrared light is typically passed through a sample and the transmitted light is dispersed and its spectral intensity recorded. The absorption lines reveal the excited vibrational transitions. In the following, we will discuss the theoretical background of these spectra and then show how they can be simulated."><link data-react-helmet="true" rel="shortcut icon" href="/docs/img/favicon.png"><link data-react-helmet="true" rel="canonical" href="https://docs.c6h6.org/docs/eln/uuid/10b6a7229db7dd815afcc75e77c2d6cd"><link data-react-helmet="true" rel="alternate" href="https://docs.c6h6.org/docs/eln/uuid/10b6a7229db7dd815afcc75e77c2d6cd" hreflang="en"><link data-react-helmet="true" rel="alternate" href="https://docs.c6h6.org/docs/eln/uuid/10b6a7229db7dd815afcc75e77c2d6cd" hreflang="x-default"><link rel="stylesheet" href="/docs/assets/css/styles.9535995b.css">
<link rel="preload" href="/docs/assets/js/runtime~main.bf15b642.js" as="script">
<link rel="preload" href="/docs/assets/js/main.8f7ec10f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();t(null!==e?e:"light")}()</script><div id="__docusaurus">
<div><a href="#" class="skipToContent_1oUP">Skip to main content</a></div><nav class="navbar navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><button aria-label="Navigation bar toggle" class="navbar__toggle clean-btn" type="button" tabindex="0"><svg width="30" height="30" viewBox="0 0 30 30" aria-hidden="true"><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><a class="navbar__brand" href="/docs/"><div class="navbar__logo"><img src="/docs/img/logo.png" alt="Cheminfo logo" class="themedImage_1VuW themedImage--light_3UqQ"><img src="/docs/img/logo.png" alt="Cheminfo logo" class="themedImage_1VuW themedImage--dark_hz6m"></div></a><a class="navbar__item navbar__link navbar__link--active" href="/docs/eln/">Documentation</a></div><div class="navbar__items navbar__items--right"><a href="https://github.com/cheminfo" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link"><span>GitHub<svg width="13.5" height="13.5" aria-hidden="true" viewBox="0 0 24 24" class="iconExternalLink_3J9K"><path fill="currentColor" d="M21 13v10h-21v-19h12v2h-10v15h17v-8h2zm3-12h-10.988l4.035 4-6.977 7.07 2.828 2.828 6.977-7.07 4.125 4.172v-11z"></path></svg></span></a><div class="toggle_71bT toggle_3Zt9 toggleDisabled_3cF-"><div class="toggleTrack_32Fl" role="button" tabindex="-1"><div class="toggleTrackCheck_3lV7"><span class="toggleIcon_O4iE">ðŸŒœ</span></div><div class="toggleTrackX_S2yS"><span class="toggleIcon_O4iE">ðŸŒž</span></div><div class="toggleTrackThumb_xI_Z"></div></div><input type="checkbox" class="toggleScreenReader_28Tw" aria-label="Switch between dark and light mode"></div><div class="navbar__search searchBarContainer_MM2z"><input placeholder="Search" aria-label="Search" class="navbar__search-input"><div class="loadingRing_s5VG searchBarLoadingRing_2jQk"><div></div><div></div><div></div><div></div></div></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div></nav><div class="main-wrapper docs-wrapper docs-doc-page"><div class="docPage_31aa"><button aria-label="Scroll back to top" class="clean-btn theme-back-to-top-button backToTopButton_35hR" type="button"></button><aside class="docSidebarContainer_3Kbt"><div class="sidebar_15mo"><nav class="menu thin-scrollbar menu_Bmed"><ul class="theme-doc-sidebar-menu menu__list"><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-1 menu__list-item"><a class="menu__link" href="/docs/eln/">Getting started</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">introduction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Landing page</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Samples</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#">Structural analysis</a><ul style="display:block;overflow:visible;height:auto" class="menu__list"><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Chromatography</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/eln/uuid/bf1f6acc30fc6c92c730ea434234530c">Elemental analysis</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/eln/uuid/3fc7caa33b9b3eb50bb48920f4788725">Infrared spectra</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link menu__link--active" aria-current="page" tabindex="0" href="/docs/eln/uuid/10b6a7229db7dd815afcc75e77c2d6cd">IR spectra prediction</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">Mass spectrometry</a></li><li class="theme-doc-sidebar-item-link theme-doc-sidebar-item-link-level-2 menu__list-item"><a class="menu__link" tabindex="0" href="/docs/eln/uuid/ef39548735eda960577b1ff9a6c5d7fa">Ultraviolet spectra</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-2 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#" tabindex="0">NMR</a></li></ul></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Physical chemistry/Materials science</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Other analysis</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Machine learning</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Cheminformatics</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">ELN / Reactions</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Reporting and publications</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">Other functionalities</a></li><li class="theme-doc-sidebar-item-category theme-doc-sidebar-item-category-level-1 menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#">For developers</a></li></ul></nav><button type="button" title="Collapse sidebar" aria-label="Collapse sidebar" class="button button--secondary button--outline collapseSidebarButton_1CGd"><svg width="20" height="20" aria-hidden="true" class="collapseSidebarButtonIcon_3E-R"><g fill="#7a7a7a"><path d="M9.992 10.023c0 .2-.062.399-.172.547l-4.996 7.492a.982.982 0 01-.828.454H1c-.55 0-1-.453-1-1 0-.2.059-.403.168-.551l4.629-6.942L.168 3.078A.939.939 0 010 2.528c0-.548.45-.997 1-.997h2.996c.352 0 .649.18.828.45L9.82 9.472c.11.148.172.347.172.55zm0 0"></path><path d="M19.98 10.023c0 .2-.058.399-.168.547l-4.996 7.492a.987.987 0 01-.828.454h-3c-.547 0-.996-.453-.996-1 0-.2.059-.403.168-.551l4.625-6.942-4.625-6.945a.939.939 0 01-.168-.55 1 1 0 01.996-.997h3c.348 0 .649.18.828.45l4.996 7.492c.11.148.168.347.168.55zm0 0"></path></g></svg></button></div></aside><main class="docMainContainer_3ufF"><div class="container padding-top--md padding-bottom--lg"><div class="row"><div class="col docItemCol_3FnS"><div class="docItemContainer_33ec"><article><div class="tocCollapsible_1PrD theme-doc-toc-mobile tocMobile_3Hoh"><button type="button" class="clean-btn tocCollapsibleButton_2O1e">On this page</button></div><div class="theme-doc-markdown markdown"><header><h1>IR spectra prediction</h1></header><p>In infrared spectroscopy, broadband infrared light is typically passed through a sample and the transmitted light is dispersed and its spectral intensity recorded. The absorption lines reveal the excited vibrational transitions. In the following, we will discuss the theoretical background of these spectra and then show how they can be simulated.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="theoretical-background">Theoretical background<a aria-hidden="true" class="hash-link" href="#theoretical-background" title="Direct link to heading">â€‹</a></h2><h3 class="anchor anchorWithStickyNavbar_31ik" id="selection-rules">Selection rules<a aria-hidden="true" class="hash-link" href="#selection-rules" title="Direct link to heading">â€‹</a></h3><p>From theoretical spectroscopy one can derive that an electronic transition between some initial state $i$ and final state $f$ is allowed if the transition moment is not zero:</p><p>$$
|\mathbf{\mu}<em>{if}| = \left| \int \psi</em>{\mu<em>f}^* \mathbf{\mu} \psi</em>{\mu_i} \mathrm{d}V \right|
$$</p><p>If we assume that the Born-Oppenheimer approximation holds, we can separate the wave functions $\psi$ into an electronic and nuclear part and analyze them separately:</p><p>$$
\psi_\mu(\mathbf{r}) = \psi_e (\mathbf{r}_e, \mathbf{r}_N) \cdot \psi_N (\mathbf{r}_N)
$$</p><p>If we focus, for simplicity, on diatomic molecules we can decompose the nuclear motion into an oscillation (harmonic oscillator) and rotation (rigid rotator) part:</p><p>$$
\psi<em>N(\mathbf{r}_N) = \psi_v(q) \cdot \psi</em>{J, m_J} (\theta, \phi)
$$</p><p>with $q$ being the internuclear distance.</p><p>For vibrational transitions we can analyze only the contributions from the oscillation part, for which the wave function can be written as</p><p>$$
\psi_v(q) = A_v \cdot H_v(\alpha q) \exp\left(-\frac{-(\alpha q)^2}{2}\right)
$$</p><p>where the $H_v$ are Hermite polynomials.</p><p>For the vibrational transition, we can now evaluate</p><p>$$
\mathbf{\mu}<em>{if} = \int \psi^*</em>{V<em>f} (q) \mathbf{\mu} \psi</em>{V_i}(q) \, \mathrm{d}V
$$</p><p>For the diatomic case, we can simplify to one dimension by setting $q$ to $x$ and $\mathrm{d}V$ to $\mathrm{d}x$.</p><p>The first way this integral can vanish is if $\mathbf{\mu}$ is zero. This would mean we do not &quot;see&quot; this transition --- it is forbidden.</p><p>For small changes, we can approximate $\mathbf{\mu}(x)$ using a Taylor expansion</p><p>$$
\mu(x) = \mu<em>0 + \left(\frac{\mathrm{d}\mu}{\mathrm{d}x} \right)</em>{x=x_0}x + \dots
$$</p><p>If we plug in the first term, we find that the transition dipole moment is zero because the Hermite polynomials $H_v$ are orthogonal (for $v_i \neq v_f$):</p><p>$$
\mathbf{\mu}<em>{if} = \mu_0 \int</em>{-\infty}^{\infty} \psi^*<em>{V_f} (x)  \psi</em>{V_i}(x) \, \mathrm{d}x = 0
$$</p><p>For the remaining terms we can write in general</p><p>$$
\mathbf{\mu}<em>{if} = \frac{1}{n!} \left(\frac{\mathrm{d}^n\mu}{\mathrm{d}x} \right)</em>{x=x<em>0}\int</em>{-\infty}^{\infty} x^n \psi^*<em>{V_f} (x)  \psi</em>{V_i}(x) \, \mathrm{d}x = 0
$$</p><p>which will be zero if</p><p>$$
\left(\frac{\mathrm{d}^n\mu}{\mathrm{d}x} \right)_{x=x_0} = 0
$$</p><p>That is, a molecule must have <em>a dipole moment that changes with displacement to show an IR transition</em>.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="specific-selection-rule">Specific selection rule<a aria-hidden="true" class="hash-link" href="#specific-selection-rule" title="Direct link to heading">â€‹</a></h4><p>If one analyzes</p><p>$$
\mathbf{\mu}<em>{if} = \frac{1}{n!} \left(\frac{\mathrm{d}^n\mu}{\mathrm{d}x} \right)</em>{x=x<em>0}\int</em>{-\infty}^{\infty} x^n \psi^*<em>{V_f} (x)  \psi</em>{V_i}(x) \, \mathrm{d}x = 0
$$</p><p>in the harmonic approximation one finds that only transitions between neighboring levels are allowed $\Delta \nu = \pm 1$.
Real bonds, however, are not perfectly harmonic. For this reason, also higher order transitions might be allowed -- those are called overtones and are of lower intensity.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="spectra-from-the-hessian">Spectra from the Hessian<a aria-hidden="true" class="hash-link" href="#spectra-from-the-hessian" title="Direct link to heading">â€‹</a></h3><p>If we assume our vibrations are harmonic, we can do a good job by approximating the potential around some (local) minimum using a Taylor approximation</p><p>$$
V=V<em>{0}+\sum</em>{i=1}^{3 N}\left(\frac{\partial V}{\partial q<em>{i}}\right)</em>{0} q<em>{i}+\frac{1}{2} \sum</em>{i=1}^{3 N}\left(\frac{\partial^{2} V}{\partial q<em>{i} \partial q</em>{j}}\right)<em>{0} q</em>{i} q_{j}+\cdots
$$</p><p>From Newton&#x27;s equations of motion we know</p><p>$$
\ddot{q}<em>{j}+\sum</em>{i=1}^{3 N} f<em>{i j} q</em>{i} = 0
$$</p><p>This is a differential equation (of the harmonic oscillator), which is solved, for example, by</p><p>$$
q<em>{i}=a</em>{i} \cos (\sqrt{\lambda} t+\phi)
$$</p><p>If we substitute this potential solution back in our differential equation we find an eigenvalue problem</p><p>$$
\sum<em>{i=1}^{3 N}\left(f</em>{i j}-\delta<em>{i j} \lambda\right) a</em>{i}=0 \quad j=1,2, \cdots, 3 N
$$</p><p>What does this mean? The eigenvectors $\mathbf{a}<em>k$ are the normal modes that describe the motion of the atoms for the mode with eigenvalue $\lambda_k$. It is important to realize that according to $a</em>{i} \cos (\sqrt{\lambda} t+\phi)$ all atoms move with the same phase and frequency -- but different amplitudes. It is important to realize that $\lambda$ is proportional to the force constant. Stiffer bonds hence mean a higher frequency. This is the connection between electronic effects of the substituent and changes in vibrational frequencies.</p><p>What do we now need to do in practice to get to these eigenvalues and eigenvectors?</p><ol><li>We need to find an equilibrium geometry. For this, we perform a conformer search and then perform a geometry optimization.</li><li>We need to construct the matrix $\mathbf{F}$ of second derivatives $f_{i j}$. For this, we use finite differences of the form</li></ol><p>$$
\frac{\partial^{2} E<em>{e}}{\partial x</em>{\alpha} \partial y<em>{\beta}} \approx\left[\left.\left(\frac{\partial E</em>{e}}{\partial y<em>{\beta}}\right)\right|</em>{x<em>{\alpha}=x</em>{\alpha 0}+\Delta x<em>{\alpha}}-\left.\left(\frac{\partial E</em>{e}}{\partial y<em>{\beta}}\right)\right|</em>{x<em>{\alpha}=x</em>{\alpha 0}-\Delta x<em>{\alpha}}\right] / 2 \Delta x</em>{\alpha}
$$</p><p>that is, we displace the atoms and then calculate the difference in forces/energies to numerically estimate the second derivative.</p><p>If we have this matrix, we can solve the eigenvalue problem and get the normal modes with their frequencies.</p><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Conformer search</h5></div><div class="admonition-content"><p>In our case, conformer generation is based on a <a href="https://github.com/rdkit/UGM_2015/blob/master/Presentations/ETKDG.SereinaRiniker.pdf" target="_blank" rel="noopener noreferrer">stochastic algorithm that generates random distances within bounds of minimum and maximum distances of pairs of elements</a>. It turns out that these distance matrices can be projected into three dimensions, i.e., coordinates for every atom.
To improve the performance of these distance geometry algorithms they are often <a href="https://pubs.acs.org/doi/abs/10.1021/acs.jcim.5b00654" target="_blank" rel="noopener noreferrer">refined using information, such as preferred torsional angles, extracted from the Cambridge Crystallographic database</a>.</p></div></div><div class="admonition admonition-info alert alert--info"><div class="admonition-heading"><h5><span class="admonition-icon"><svg xmlns="http://www.w3.org/2000/svg" width="14" height="16" viewBox="0 0 14 16"><path fill-rule="evenodd" d="M7 2.3c3.14 0 5.7 2.56 5.7 5.7s-2.56 5.7-5.7 5.7A5.71 5.71 0 0 1 1.3 8c0-3.14 2.56-5.7 5.7-5.7zM7 1C3.14 1 0 4.14 0 8s3.14 7 7 7 7-3.14 7-7-3.14-7-7-7zm1 3H6v5h2V4zm0 6H6v2h2v-2z"></path></svg></span>Semi-empiricial quantum chemistry vs. force fields</h5></div><div class="admonition-content"><p>In the view, we give the option to select different methods for geometry optimization and calculation of the vibrational spectrum.</p><p><em>Force-fields</em> approximate the potential energy surface $U(q)$ in some simple parametrization based on interaction terms between different atom pairs --- often for bonds, bends (angles), and torsions (dihedral angles) between different atom types. The force-field we use in the service is called <a href="https://onlinelibrary.wiley.com/doi/full/10.1002/anie.202004239" target="_blank" rel="noopener noreferrer">GFN-NN</a>. Its parameters were derived from fitting to DFT derived geometries, vibrational frequencies, and non-covalent interactions of about 8000 structures covering a wide range of chemistry. In contrast to other force field parametrizations it uses an electronegativity-equilibrium (EEQ) atomic-charge model to describe the electrostatic interactions, and it avoids element <em>pair</em> specific parametrization .</p><p>From a computational point of view, GFN-FF&#x27;s computational cost scales quadratically with system size.</p><p>The other methods we offer are <em>semi-empirical quantum-mechanical</em> methods. The key idea behind semi-empirical methods such as the <a href="https://en.wikipedia.org/wiki/H%C3%BCckel_method" target="_blank" rel="noopener noreferrer">Hueckel method</a> is that they approximate difficult integrals. An important flavor of semiempirical methods are <a href="https://www.tandfonline.com/doi/full/10.1080/23746149.2019.1710252" target="_blank" rel="noopener noreferrer">density-functional tight-binding methods where the energy is expanded in term of density fluctuations relative to a superposition of atomic reference densities</a>:</p><p>$$
\begin{aligned}
&amp;E<!-- -->[\rho(r)]<!-- -->=E\left<!-- -->[\rho_{0}(\mathbf{r})\right]<!-- -->+\left.\int \frac{\delta E<!-- -->[\rho(\mathbf{r})]<!-- -->}{\delta \rho(\mathbf{r})}\right|<em>{\rho</em>{0}} \delta \rho(\mathbf{r}) <!-- -->\<!-- -->
&amp;+\left.\frac{1}{2} \iint \frac{\delta^{2} E<!-- -->[\rho(\mathbf{r})]<!-- -->}{\delta \rho(\mathbf{r}) \delta \rho\left(\mathbf{r}^{\prime}\right)}\right|<em>{\rho</em>{0}} \delta \rho(\mathbf{r}) \delta \rho\left(\mathbf{r}^{\prime}\right) \ldots <!-- -->\<!-- -->
&amp;+\left.\frac{1}{p !} \iint \ldots \int \frac{\delta E\left<!-- -->[\rho\left(\mathbf{r}^{\prime}\right)\right]<!-- -->}{\delta \rho(\mathbf{r}) \delta \rho\left(\mathbf{r}^{\prime}\right) \ldots \delta \rho\left(\mathbf{r}^{(p)}\right)}\right|<em>{\rho</em>{0}} \delta \rho(\mathbf{r}) \delta \rho\left(\mathbf{r}^{\prime \prime}\right) \ldots \delta \rho\left(\mathbf{r}^{(\mathbf{p})}\right)+\ldots
\end{aligned}
$$</p><p><a href="https://pubs.acs.org/doi/10.1021/acs.jctc.8b01176" target="_blank" rel="noopener noreferrer">The GFN-xTB techniques build on top of this idea.</a> In approximating the integrals, one introduces empirical parameters which in the GFN-xTB scheme are again fitted for atoms -- but not for the pairs (in contrast to conventional DFTB methods).</p></div></div><h3 class="anchor anchorWithStickyNavbar_31ik" id="degrees-of-freedoms">Degrees of freedoms<a aria-hidden="true" class="hash-link" href="#degrees-of-freedoms" title="Direct link to heading">â€‹</a></h3><p>Key for the interpretation of the spectra is to realize that a system with $N$ particles, has $3N$ degrees of freedom. These degrees of freedom can be aggregated into different collective motions of the atoms:</p><ul><li>3 degrees of freedom describe the movement of the center of mass in the three spatial directions. To say in other words, the &quot;first&quot; three degrees of freedom describe translations.</li><li>In addition to changing the center of mass, the molecule can also rotate in different ways, which leaves the center of mass fixed. However, we have to make a distinction between linear and non-linear molecules. For linear molecules there is no rotation around the molecular axis -- you can explore this in the view if you compare carbon dioxide and water. For non-linear molecules, however, there are rotations around three distinct axes</li><li>If we now subtract the translational and rotational modes we have $3N-5$ vibrational degrees of freedom for linear molecules and $3N-6$ vibrational degrees of freedom for non-linear molecules. You can confirm this using the animations in the view.</li></ul><p>You can get an overview of many of the concepts from a lecture of Professor Frank Neese</p><iframe width="560" height="315" src="https://www.youtube-nocookie.com/embed/iJjg2L1F8I4" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; clipboard-write; encrypted-media; gyroscope; picture-in-picture"></iframe><h2 class="anchor anchorWithStickyNavbar_31ik" id="using-the-view">Using the view<a aria-hidden="true" class="hash-link" href="#using-the-view" title="Direct link to heading">â€‹</a></h2><p>The prediction view has a view key elements:
<img alt="IR prediction view elements" src="/docs/assets/images/ir_overview-51f0d4c48bd5f998bd17c4e1a98c61de.png"></p><ol><li>A structural editor allows you to edit structures. Below, you can select the level of theory for the simulations and start the new simulations.
<img alt="Draw molecule" src="/docs/assets/images/draw_molecule_optimized-c3812276cf92c99f39c87054a0e1b2b1.gif"></li><li>A table of structures lists all the structures that can be visualized. By clicking on a row you change the data that is loaded for the table of vibrational modes and the animations. It also changes the highlight in the plot.</li><li>The graph by default overlays the predicted spectra, and you can hide/unhide the spectrum of molecules by clicking on the eye.
<img alt="IR spectra graph" src="/docs/assets/images/ir_graph-e1f9433fef25f459adc8156e980880ad.gif"></li><li>A table of vibrational modes gives you the intensity (a mode of intensity 0 will not show up in the spectrum, i.e., is not IR active) and the frequency. If you click a row, it will load this mode in the animation and also highlight it in the graph.
<img alt="Mode table" src="/docs/assets/images/mode_table_optimized-6b31e7f1b3bc0aa163ed23cb81c985c5.gif"></li><li>A JSMol window animates the selected normal mode</li><li>A molecular drawing in which you can click on bonds and atoms to select the most relevant mode for this bond/atom.
<img alt="Click bond" src="/docs/assets/images/click_image_optimized-750cdf43b3591e9bc9adf7fd477c2f14.gif"></li><li>A button to open the help menu
<img alt="Open the help" src="/docs/assets/images/ir_open_help-20acdb5a8f48aba4f5e0ac30b5cf85c0.gif"></li></ol><p>To get started, and to explore some key electronic effects, you can use the dropdown menu to select a collection of predefined molecules. This option will load a collection of molecules in the table (2) for which you can then compare the predicted spectra.</p><h3 class="anchor anchorWithStickyNavbar_31ik" id="curated-collections">Curated collections<a aria-hidden="true" class="hash-link" href="#curated-collections" title="Direct link to heading">â€‹</a></h3><p>To load a pre-defined collection, you can click on the smiley in the molecule table. There you can select from different molecule collections, which will be simulated once you click the button.</p><p><img alt="Run curated collection" src="/docs/assets/images/predefined_set_optimized-c4a9c6e2cf673c1b79689c7708149c72.gif"></p><p>We currently provide a set of collection illustration important effects from organic chemistry, using the carbonyl stretching frequency as &quot;probe&quot;. The important thing to remember throughout is that a stronger bond implies a higher force constant, which implies a higher wavenumber</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="the-inductive-and-mesomeric-effect">The inductive and mesomeric effect<a aria-hidden="true" class="hash-link" href="#the-inductive-and-mesomeric-effect" title="Direct link to heading">â€‹</a></h4><p>The two most widely discussed effects in organic chemistry are the inductive and mesomeric effect.</p><p>The inductive effect describes changes in electron density that functional groups induce via $\sigma$ bonds. Electron-withdrawing (electronegative) groups will attract electrons and hence make the neighboring atom more &quot;positive&quot;. This will have an impact on the bond strength, which will manifest itself in the vibrational frequency.</p><p>In contrast to that, the mesomeric effect is transmitted via $\pi$ bonds and can be visualized via resonance structures. Again, this has an effect on the electron density in neighboring bonds, which can be thought of changing the force constant and hence the vibrational frequency.</p><p><img alt="electronic effects" src="/docs/assets/images/effects-b412c13fe7c2da68c7e3a252e0cd10bb.png"></p><h4 class="anchor anchorWithStickyNavbar_31ik" id="steric-effects">Steric effects<a aria-hidden="true" class="hash-link" href="#steric-effects" title="Direct link to heading">â€‹</a></h4><p>Clearly, there is a relation between structure and geometry. One example of this are sterically demanding substituents. Those might force the molecule to adopt a bent or rotated conformation. This can reduce the overlap between $\pi$ systems, and hence reduce the mesomeric effect--which will be reflected in the carbonyl stretching frequency.</p><h4 class="anchor anchorWithStickyNavbar_31ik" id="ring-strain">Ring strain<a aria-hidden="true" class="hash-link" href="#ring-strain" title="Direct link to heading">â€‹</a></h4><p>In several types of reaction the driving force comes from release of so-called ring strain. Ring strain describes that the atoms are forced into a geometry &quot;they do not like&quot;. Interestingly, those constrained geometries also have difference responses of neighboring bonds in the case of vibrations. For example, you will see in the animation that the bond lengths have to change much more in the case of small rings than in large rings. This can be thought of inducing a larger force constant, which manifests itself in an absorption at a higher wavenumber.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="adding-new-series">Adding new series<a aria-hidden="true" class="hash-link" href="#adding-new-series" title="Direct link to heading">â€‹</a></h2><p>To add a new series, you can right-click and move to the <code>Series</code> layer.
There you will be able to edit the curated collections or add new ones.
To add a new series, simply add a new row in the table on the top left. Then you can use the table in the bottom middle to add molecules to this collection.</p><p><img alt="Adding a new series" src="/docs/assets/images/adding_new_series-fbbf1b82ec77cd11aed7366cf7621a7a.gif"></p><p>Note that the data is saved in the view. Therefore, you need to have the rights to save the view.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="using-the-rest-api">Using the REST-API<a aria-hidden="true" class="hash-link" href="#using-the-rest-api" title="Direct link to heading">â€‹</a></h2><p>The simulations are performed on a web service. You can, of course, use the web service independent of the front end. More documentation can be found <a href="https://ir.cheminfo.org/v1/docs" target="_blank" rel="noopener noreferrer">here</a>.
The web service uses a Python backend that you can also run on your local machine. You can find more details about this <a href="https://github.com/cheminfo-py/xtbservice/" target="_blank" rel="noopener noreferrer">here</a>.</p><h2 class="anchor anchorWithStickyNavbar_31ik" id="references">References<a aria-hidden="true" class="hash-link" href="#references" title="Direct link to heading">â€‹</a></h2><ol><li>Malte Oppermann: Lecture notes for &quot;Electronic spectroscopy&quot;, 2015.</li><li><a href="https://journals.aps.org/prb/abstract/10.1103/PhysRevB.54.7830" target="_blank" rel="noopener noreferrer">Porezag, D. &amp; Pederson, M. R. Infrared intensities and Raman-scattering activities within density-functional theory. Phys. Rev. B 54, 7830â€“7836 (1996).</a></li><li><a href="http://vergil.chemistry.gatech.edu/courses/chem6485/pdf/vibrations.pdf" target="_blank" rel="noopener noreferrer">C. David Sherrill: Lecture notes &quot;Molecular Vibrations&quot;</a></li></ol></div><footer class="theme-doc-footer docusaurus-mt-lg"><div class="theme-doc-footer-edit-meta-row row"><div class="col"><a href="https://github.com/cheminfo/eln-docs/edit/main/docs/30_structural_analysis/ir-prediction/README.md" target="_blank" rel="noreferrer noopener" class="theme-edit-this-page"><svg fill="currentColor" height="20" width="20" viewBox="0 0 40 40" class="iconEdit_2_ui" aria-hidden="true"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div><div class="col lastUpdated_13-_"></div></div></footer></article><nav class="pagination-nav docusaurus-mt-lg" aria-label="Docs pages navigation"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/docs/eln/uuid/3fc7caa33b9b3eb50bb48920f4788725"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">Â« <!-- -->Infrared spectra</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/docs/eln/structural_analysis/mass/introduction/README"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">Introduction<!-- --> Â»</div></a></div></nav></div></div><div class="col col--3"><div class="tableOfContents_35-E thin-scrollbar theme-doc-toc-desktop"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#theoretical-background" class="table-of-contents__link toc-highlight">Theoretical background</a><ul><li><a href="#selection-rules" class="table-of-contents__link toc-highlight">Selection rules</a></li><li><a href="#spectra-from-the-hessian" class="table-of-contents__link toc-highlight">Spectra from the Hessian</a></li><li><a href="#degrees-of-freedoms" class="table-of-contents__link toc-highlight">Degrees of freedoms</a></li></ul></li><li><a href="#using-the-view" class="table-of-contents__link toc-highlight">Using the view</a><ul><li><a href="#curated-collections" class="table-of-contents__link toc-highlight">Curated collections</a></li></ul></li><li><a href="#adding-new-series" class="table-of-contents__link toc-highlight">Adding new series</a></li><li><a href="#using-the-rest-api" class="table-of-contents__link toc-highlight">Using the REST-API</a></li><li><a href="#references" class="table-of-contents__link toc-highlight">References</a></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="footer__bottom text--center"><div class="footer__copyright">Copyright Â© 2021 Cheminfo contributors. Built with Docusaurus.</div></div></div></footer></div>
<script src="/docs/assets/js/runtime~main.bf15b642.js"></script>
<script src="/docs/assets/js/main.8f7ec10f.js"></script>
</body>
</html>